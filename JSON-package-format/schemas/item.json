{
  "$id": "https://schemas.cudl.lib.cam.ac.uk/package/v1/item.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "html": {
      "type": "string",
      "contentMediaType": "text/html"
    },
    "itemProperties": {
      "description": "An open set of key-value properties with string, boolean and number values, or arrays of the same. ",
      "type": "object",
      "additionalProperties": {
        "anyOf": [
          {
            "type": [
              "string",
              "boolean",
              "number"
            ]
          },
          {
            "type": "array",
            "items": {
              "type": [
                "string",
                "boolean",
                "number"
              ]
            }
          }
        ]
      }
    },
    "pageReference": {
      "description": "An identifier for a specific page.",
      "oneOf": [
        {
          "type": "string",
          "description": "The name of a key in the \"pages\" object."
        },
        {
          "type": "boolean",
          "description": "The very first or last page, depending on which of \"firstPage\" or \"lastPage\" it's used with.",
          "enum": [
            true
          ]
        }
      ]
    },
    "metadataProperty": {
      "type": "object",
      "required": [
        "label",
        "value",
        "order"
      ],
      "properties": {
        "label": {
          "description": "Label for this property, e.g. 'Title'.",
          "type": "string"
        },
        "value": {
          "description": "The value for this property .e.g. 'Elementary Mathematics'.  Also supports an array of strings where there are several separate values, e.g. multiple alternative titles.",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ]
        },
        "order": {
          "description": "This is used to decide the order of display in the list of metadata. e.g. '1. Title.' is before '2. Classmark'. ",
          "type": "string"
        }
      }
    },
    "metadataProperties": {
      "type": "object",
      "description": "These are properties allowed for each metadata section.",
      "required": [
        "coverage"
      ],
      "additionalProperties": false,
      "properties": {
        "coverage": {
          "type": "object",
          "required": [
            "firstPage",
            "lastPage"
          ],
          "additionalProperties": false,
          "properties": {
            "firstPage": {
              "$ref": "#/definitions/pageReference"
            },
            "lastPage": {
              "$ref": "#/definitions/pageReference"
            }
          }
        },
        "attributes": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/metadataProperty"
          }
        }
      }
    }
  },
  "title": "Package JSON Item",
  "description": "This contains the information to describe an item (book, manuscript, etc) in the digital library.",
  "required": [
    "descriptions",
    "pages",
    "properties",
    "type"
  ],
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "type": {
      "type": "string",
      "format": "uri-reference"
    },
    "additionalProperties": false,
    "properties": {
      "$ref": "#/definitions/itemProperties"
    },
    "descriptions": {
      "type": "object",
      "required": [
        "main"
      ],
      "additionalProperties": {
        "$ref": "#/definitions/metadataProperties"
      }
    },
    "pages": {
      "type": "object",
      "description": "Pages is a list of objects that represent each page in the item.",
      "additionalProperties": {
        "type": "object",
        "description": "Each page has an object that contains the label, order and image attributes.",
        "required": [
          "label",
          "order",
          "image"
        ],
        "additionalProperties": true,
        "properties": {
          "label": {
            "description": "The label for this page, e.g. 2v",
            "type": "string"
          },
          "order": {
            "description": "This is used to determine the order for display.",
            "type": "string"
          },
          "image": {
            "type": "object",
            "description": "An object representing the image for this page.",
            "additionalProperties": true,
            "properties": {
              "type": {
                "description": "The image format.",
                "type": "string"
              },
              "href": {
                "description": "The local path to the image for this page relative to the image storage location, e.g. images/mypicture.tiff",
                "format": "uri-reference",
                "type": "string"
              }
            }
          }
        }
      }
    }
  }
}
